function ajaxGET(e,t){currentHeight=0;var n=false;try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(r){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){n=false}}if(!n&&typeof XMLHttpRequest!="undefined"){try{n=new XMLHttpRequest}catch(r){n=false}}if(!n&&window.createRequest){try{n=window.createRequest()}catch(r){n=false}}n.open("GET",e,true);n.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2005 00:00:00 GMT");n.onreadystatechange=function(){if(n.readyState==4){getMyHTMLElement(t).innerHTML=n.responseText;processAdditionalAjaxCommands(t)}};n.send(null)}function setCookieCompliance(){ajaxGET("/page/ajx_cookiecompliance/?value=yes"+generateQueryStrings(),"mainCookieBanner")}function generateAutoComplete(e){if(e.length>2){e=escape(e);ajaxGET("/page/ajx_search/?searchterm="+e+generateQueryStrings(),"SearchDrop")}}function hideSearchDrop(e){$("#"+e).hide("slow","",500,"")}function processAdditionalAjaxCommands(e){switch(e){case"SearchDrop":$("#SearchDrop").show("slow","",500,"");break;case"ajaxProductListing":if(getMyHTMLElement("ajaxFacetResults")!=null){if(getMyHTMLElement("ajaxFacetResults").innerHTML!=""){getMyHTMLElement("facetMiddleBlock").innerHTML=getMyHTMLElement("ajaxFacetResults").innerHTML}}if(ajaxSelection==""){updateToAjaxVersion("YouAreHere");updateToAjaxVersion("productDataOnPage");updateToAjaxVersion("productDataNavRightTOP");updateToAjaxVersion("productDataNavRightBOTTOM")}if(ajaxSelection=="sort"){updateToAjaxVersion("productDataOnPage");updateToAjaxVersion("productDataNavRightTOP");updateToAjaxVersion("productDataNavRightBOTTOM")}if(ajaxSelection=="prodperpage"){updateToAjaxVersion("productDataNavLeftBOTTOM");updateToAjaxVersion("productDataNavRightTOP");updateToAjaxVersion("productDataNavRightBOTTOM");updateToAjaxVersion("productDataOnPage")}if(ajaxSelection=="paging"){updateToAjaxVersion("productDataNavRightTOP");updateToAjaxVersion("productDataNavRightBOTTOM");updateToAjaxVersion("productDataOnPage")}$(document).ready(function(){$("img.lazy").show().lazyload({effect:"fadeIn"})});break;case"ajaxBASKET":updateToAjaxVersion("basketSummaryText");updateToAjaxVersion("basketSummaryMenu");updateToAjaxVersion("itemAddedbasketSummaryMenu");showDisplayTable("addToBasket");hideDisplayTable("addToBasketLoading");showDisplayTable("itemAddedbasketSummaryMenu");thinkAboutHidingTable("itemAddedbasketSummaryMenu");break;case"ajaxReview":$(document).ready(function(){$(".star").rating({callback:function(e,t){$("[name=customer_rating]").val(e);document.getElementById("error_rating").style.display="none"}})});break;case"ajaxServiceReview":$(document).ready(function(){$(".star").rating({callback:function(e,t){$("[name=customer_rating]").val(e);document.getElementById("error_rating").style.display="none"}})});break;case"captchavalidation":if(document.getElementById("captchaValidate").value=="0"||document.getElementById("captchaValidate").value==""){document.getElementById("captchaInvalid").style.display="block"}if(document.getElementById("captchaValidate").value=="1"){document.forms["customercommentsform"].submit()}if(document.getElementById("captchaValidate").value=="3"){ajaxGET("/ajx_captcha_field.asp?showcaptchafields=1","captcha",false)}break;case"mainCookieBanner":updateToAjaxVersion("mainCookieBanner");hideCookieInfoBar();break;case"captcha":if(jumpPage=="1"){goToByScroll("review-anchor")}document.getElementById("submit_captcha").src="/images/buttons/addreview.gif";break;default:}}function updateToAjaxVersion(e){getMyHTMLElement(e).innerHTML=getMyHTMLElement(e+"ViaAjax").innerHTML;if(getMyHTMLElement(e+"ViaAjax")!=null){getMyHTMLElement(e+"ViaAjax").innerHTML=""}}function ajaxAddToBasket(e){if(e=="selectFrm"){if(document[e].sku.value==""){alert("Please select size");return false}}hideDisplayTable("addToBasket");showDisplayTable("addToBasketLoading");showBasketSummary("itemAddedbasketSummaryMenu",-118,20);ajaxGET("/page/xt_orderform_additem/?target=ajx_basket.asp&sku="+document[e].sku.value+generateQueryStrings(),"ajaxBASKET")}function ajaxAddToBasketSimple(e){showBasketSummary("itemAddedbasketSummaryMenu",-118,20);ajaxGET("/page/xt_orderform_additem/?target=ajx_basket.asp&sku="+e+generateQueryStrings(),"ajaxBASKET")}function facetChoice(e,t,n){ajaxSelection="";document.facetedSearch.filter_reproduce.value=1;prev_facetName=e;prev_facetValue=t;prev_executeFacet=n;var r=document.facetedSearch[e].value;if(r!=""){if(r.indexOf(","+t+",")>=0){document.facetedSearch[e].value=replaceString(document.facetedSearch[e].value,","+t+",",",")}else{document.facetedSearch[e].value=document.facetedSearch[e].value+","+t+","}document.facetedSearch[e].value=replaceString(document.facetedSearch[e].value,",,",",")}else{document.facetedSearch[e].value=","+t+","}document.facetedSearch.first_filter.value=replaceString(document.facetedSearch.first_filter.value,","+e+",","");if(document.facetedSearch[e].value!=""){document.facetedSearch.first_filter.value=document.facetedSearch.first_filter.value+","+e+","}if(n==true){document.facetedSearch.filter_page.value="1";executeFacetAjax()}}function executeFacetAjax(){previoushashPostionsData=self.document.location.hash;myhashPostionsData="";if(document.facetedSearch.first_filter.value!=""){myhashPostionsData=myhashPostionsData+"&filterkey="+replaceString(document.facetedSearch.first_filter.value,"filter_","")}if(document.facetedSearch.filter_cat.value!=""){myhashPostionsData=myhashPostionsData+"&cat="+document.facetedSearch.filter_cat.value}if(document.facetedSearch.filter_displayoptions.value!=""){myhashPostionsData=myhashPostionsData+"&displayoptions="+document.facetedSearch.filter_displayoptions.value}if(document.facetedSearch.filter_colour.value!=""){myhashPostionsData=myhashPostionsData+"&colour="+document.facetedSearch.filter_colour.value}if(document.facetedSearch.filter_price.value!=""){myhashPostionsData=myhashPostionsData+"&price="+document.facetedSearch.filter_price.value}if(document.facetedSearch.filter_brand.value!=""){myhashPostionsData=myhashPostionsData+"&brand="+document.facetedSearch.filter_brand.value}if(document.facetedSearch.filter_displayoptions2.value!=""){myhashPostionsData=myhashPostionsData+"&displayoptions2="+document.facetedSearch.filter_displayoptions2.value}if(document.facetedSearch.filter_size.value!=""){myhashPostionsData=myhashPostionsData+"&size="+document.facetedSearch.filter_size.value}if(document.facetedSearch.filter_page.value!=""){myhashPostionsData=myhashPostionsData+"&page="+document.facetedSearch.filter_page.value}if(document.facetedSearch.order.value!=""){myhashPostionsData=myhashPostionsData+"&order="+document.facetedSearch.order.value}if(document.facetedSearch.productsperpage.value!=""){myhashPostionsData=myhashPostionsData+"&productsperpage="+document.facetedSearch.productsperpage.value}if(myhashPostionsData==""){if(previoushashPostionsData!=myhashPostionsData){self.document.location.hash=""}}else{if(strRight(myhashPostionsData,1)==","){myhashPostionsData=strLeft(myhashPostionsData,myhashPostionsData.length-1)}if(strLeft(myhashPostionsData,1)=="&"){myhashPostionsData=strRight(myhashPostionsData,myhashPostionsData.length-1)}myhashPostionsData=replaceString(myhashPostionsData,"=,","=");myhashPostionsData=replaceString(myhashPostionsData,",=","=");myhashPostionsData=replaceString(myhashPostionsData,",&","&");myhashPostionsData=replaceString(myhashPostionsData,",,",",");facetCheckCount=facetCheckCount+1;myhashPostionsData=myhashPostionsData+"&facetchecker="+facetCheckCount;self.document.location.hash=myhashPostionsData}facetAjax()}function facetAjax(){var e;e=facetURL;if(e!=""){e=replaceString(e,"first_filter_value",document.facetedSearch.first_filter.value);e=replaceString(e,"filter_cat_value",document.facetedSearch.filter_cat.value);e=replaceString(e,"filter_displayoptions_value",document.facetedSearch.filter_displayoptions.value);e=replaceString(e,"filter_colour_value",document.facetedSearch.filter_colour.value);e=replaceString(e,"filter_price_value",document.facetedSearch.filter_price.value);e=replaceString(e,"filter_brand_value",document.facetedSearch.filter_brand.value);e=replaceString(e,"filter_displayoptions2_value",document.facetedSearch.filter_displayoptions2.value);e=replaceString(e,"filter_size_value",document.facetedSearch.filter_size.value);e=replaceString(e,"filter_page_value",document.facetedSearch.filter_page.value);e=replaceString(e,"filter_order_value",document.facetedSearch.order.value);e=replaceString(e,"productsperpage_value",document.facetedSearch.productsperpage.value);e=replaceString(e,"filter_reproduce_value",document.facetedSearch.filter_reproduce.value);e=cleanUnusedQueryStringsFromURL(e);ajaxGET(e,"ajaxProductListing",false)}}function doubleCheckHashForPreDefinedFilters(){newFacetCheck=0;var e=self.document.location.hash.substring(1);var t=e.split("&");for(var n=0;n<t.length;n++){var r=t[n];var i=r.split("=");if(i[0]=="facetchecker"){newFacetCheck=i[1]}}if(newFacetCheck!=facetCheckCount){facetCheckCount=-1;document.facetedSearch.filter_page.value=1;document.facetedSearch.order.value="";document.facetedSearch.filter_displayoptions.value="";document.facetedSearch.filter_brand.value="";document.facetedSearch.filter_price.value="";document.facetedSearch.filter_cat.value="";document.facetedSearch.filter_colour.value="";document.facetedSearch.filter_size.value="";document.facetedSearch.first_filter.value="";document.facetedSearch.filter_reproduce.value=1;if(self.document.location.hash.substring(1)==""){facetAjax()}else{checkForPreDefinedFilters()}}}function checkForPreDefinedFilters(){var e=self.document.location.hash.substring(1);if(e!=""){getMyHTMLElement("productDataOnPage").innerHTML='<div class="loading"><img src="/images/core/ajax-loader.gif"/></div>';var t=e.split("&");for(var n=0;n<t.length;n++){var r=t[n];var i=r.split("=");if(i.length==2){if(i[0]=="displayoptions"||i[0]=="brand"||i[0]=="price"||i[0]=="cat"||i[0]=="colour"||i[0]=="size"){document.facetedSearch["filter_"+i[0]].value="";facetChoice("filter_"+i[0],i[1],false)}else if(i[0]=="page"){ajaxPage(i[1],false,"")}else if(i[0]=="order"){ajaxSort(i[1],false)}else if(i[0]=="filterkey"){document.facetedSearch.first_filter.value="filter_"+i[1]}}}document.facetedSearch.filter_reproduce.value=1;facetAjax()}}function cleanUnusedQueryStringsFromURL(e){var t="";qStringVals=e.split("?");qStringValArray=qStringVals[1].split("&");for(var n=0;n<qStringValArray.length;n++){qsValsIndiv=qStringValArray[n].split("=");if(qsValsIndiv[1]!=""){t=t+"&"+qsValsIndiv[0]+"="+qsValsIndiv[1]}}t=qStringVals[0]+"?"+t;t=replaceString(t,"?&","?");return t}function ajaxPage(e,t,n){document.facetedSearch.filter_page.value=e;document.facetedSearch.filter_reproduce.value=0;if(t==true){ajaxSelection=n;executeFacetAjax()}}function ajaxSort(e,t){document.facetedSearch.order.value=e;document.facetedSearch.filter_reproduce.value=0;ajaxSelection="sort";if(t==true){document.facetedSearch.filter_page.value="1";executeFacetAjax()}}function ajaxProdPerPage(e,t){document.facetedSearch.productsperpage.value=e;document.facetedSearch.filter_reproduce.value=0;ajaxSelection="prodperpage";if(t==true){document.facetedSearch.filter_page.value="1";executeFacetAjax()}}function ClearfacetChoice(){ajaxSelection="";var e=document.getElementById("facetedSearch");e.elements["filter_cat"].value="";e.elements["filter_displayoptions"].value="";e.elements["filter_colour"].value="";e.elements["filter_price"].value="";e.elements["filter_brand"].value="";e.elements["filter_displayoptions2"].value="";e.elements["filter_size"].value="";executeFacetAjax()}function ajaxEmailaFriend(){var e=function(){$("#emailAfriendBOX").css("display","block");$("#emailAfriendBOX").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+$("#emailAfriendBOX").width()/2+"px"})};showOverlayBox(e)}function forgotPasswordpopup(){var e=function(){$("#forgotpassword").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+$("#forgotpassword").width()/2+"px"});$("#forgotpassword").css("display","block")};showOverlayBox(e)}function showPopupA(e){var t=function(){$("#ajaxEditorial").html("");ajaxGET("/page/ajx_viewindex/?article_id="+e,"ajaxEditorial",false);$("#ajaxEditorial").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+$("#ajaxEditorial").width()/2+"px"});$("#ajaxEditorial").css("display","block")};showOverlayBox(t)}function showArticleSizedPopup(e,t,n){var r=function(){$("#ajaxEditorial").html("");ajaxGET("/page/ajx_viewindex/?article_id="+e,"ajaxEditorial",false);$("#ajaxEditorial").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+t/2+"px"});$("#ajaxEditorial").css("display","block");$("#ajaxEditorial").css("width",t);$("#ajaxEditorial").css("height",n);$("#ajaxEditorial").css("overflow-Y","auto");$("#ajaxEditorial").css("overflow-X","hidden")};showOverlayBox(r)}function showOverlayBox(e){$("#overlayBox").css({display:"block",width:$(window).outerWidth(),height:$(document).outerHeight()});$("#overlayBox").fadeTo(0,0).fadeTo(200,.5,e)}function showPopup(){var e=function(){$("#ajaxEditorial").html("");$("#ajaxEditorial").css("display","block")};showOverlayBox(e)}function hidePopup(){$("#forgotpassword").css("display","none");$("#emailAfriendBOX").css("display","none");$("#ajaxEditorial").css("display","none");$("#ajaxReview").css("display","none");$("#ajaxServiceReview").css("display","none");$("#overlayBox").css("display","none");$("#overlayBox").animate({opacity:0},null,null,function(){$(this).hide()})}function generateQueryStrings(){var e;e="";if(qSVariables!=""){var t=qSVariables.split(",");for(variable=0;variable<t.length;variable=variable+2){e=e+"&"+t[variable]+"="+t[variable+1]}}return e}function submitEmailonLeftNav(e,t){var n=new RegExp("^[a-zA-Z0-9][a-zA-Z0-9-_.']*@[a-zA-Z0-9-_']*.[a-zA-Z0-9-_']*[a-zA-Z0-9-_.']*[a-zA-Z0-9-_']$");var r=document.newsletter.email.value;if(r!=""&&r!="sub_box_left_email"&&r.match(n)){document.newsletter.submit()}else{alert(t)}}function sendEmailAFriend(){var e="/ajx_emailafriend.asp?pf_id="+document.emailafriendform.pf_id.value+"&recipient_name="+document.emailafriendform.recipient_name.value+"&recipient_email="+document.emailafriendform.recipient_email.value+"&sender_name="+document.emailafriendform.sender_name.value+"&sender_email="+document.emailafriendform.sender_email.value+"&email_message="+document.emailafriendform.email_message.value+generateQueryStrings();previousContentEmail=getMyHTMLElement("emailAfriendTEXT").innerHTML;invokeAJAX(e,"emailAfriendTEXT","","","","",false)}function invokeAJAX(e,t,n,r,i,s){if(t=="ajaxPRODUCTBox"){getMyHTMLElement("ajaxPRODUCTBox").src="about:blank";if(i!=""&&typeof i!="undefined"){leftAdjustInt=i/2}else{leftAdjustInt=75}centerObject("ajaxPRODUCTBox",642,395,"",300,leftAdjustInt,0);getMyHTMLElement("ajaxPRODUCTBox").src=e;showPopup("ajaxPRODUCTBox");initialised=false}else{var o;if(s==true){parent.document.getElementById(t).innerHTML='<div class="ajaxLoading"><img src="/images/core/ajaxloader.gif" alt="Please wait, the page is loading..."></div>'}else{}ajaxGET(e,t,s)}}function showReviewSizedPopup(e,t,n,r){var i=function(){$("#ajaxReview").html("");ajaxGET("/page/ajx_review/?pf_id="+e+"&pf_name="+t,"ajaxReview",false);$("#ajaxReview").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+$("#ajaxReview").width()/2+"px"});$("#ajaxReview").css("display","block");$("#ajaxReview").css("overflow-Y","auto");$("#ajaxReview").css("overflow-X","hidden")};showOverlayBox(i)}function showServiceReviewSizedPopup(e,t){var n=function(){$("#ajaxServiceReview").html("");ajaxGET("/page/ajx_service_review/","ajaxServiceReview",false);$("#ajaxServiceReview").css({top:$(document).scrollTop()+150,left:"50%",margin:"0 0 0 -"+$("#ajaxServiceReview").width()/2+"px"});$("#ajaxServiceReview").css("display","block");$("#ajaxServiceReview").css("overflow-Y","auto");$("#ajaxServiceReview").css("overflow-X","hidden")};showOverlayBox(n)}function VerifyGuestCustomer(e,t){var n=new RegExp("^[a-zA-Z0-9][a-zA-Z0-9-_.']*@[a-zA-Z0-9-_']*.[a-zA-Z0-9-_']*[a-zA-Z0-9-_.']*[a-zA-Z0-9-_']$");if(e!=""&&e.match(n)){ajaxGET("/ajx_quickaddguest.asp?email="+e+"&testabandondedemails="+t,"donothing")}else{if(t=="1")document.getElementById("donothing").innerHTML="Missing or invalid email. No action taken."}}var ajaxSelection=""